{% extends "base.html" %}

{% block title %}–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω - –î–µ—Ç—Å–∫–æ–µ –∫–∞—Ñ–µ "–†–∞–¥—É–≥–∞"{% endblock %}

{% block content %}
<div class="order-success-page">
    <div class="success-icon">üéâ</div>
    <h1>–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h1>
    
    {% if order.id %}
    <div class="order-number" style="text-align: center; margin: 20px 0;">
        <h3 style="color: #4ecdc4;">–ù–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞: #{{ order.id }}</h3>
    </div>
    {% endif %}
    
    <div class="order-details">
        <h3>–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞:</h3>
        
        {% if order_items %}
        <div class="order-items">
            {% for item in order_items %}
            <div class="order-item">
                <div class="item-info">
                    {% if item.product.image %}
                    <img src="{{ item.product.image }}" alt="{{ item.product.title }}" class="item-image">
                    {% endif %}
                    <div class="item-details">
                        <span class="item-title">{{ item.product.title }}</span>
                    </div>
                </div>
                <div class="item-price">
                    <span>{{ item.quantity }} √ó {{ item.product.price|floatformat:2 }} —Ä—É–±.</span>
                    <span class="item-total">{{ item.total|floatformat:2 }} —Ä—É–±.</span>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="no-items">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</p>
        {% endif %}
        
        {% if order.delivery_method == 'delivery' %}
        <div class="delivery-info">
            <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ:</h4>
            <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {{ delivery_price|floatformat:2 }} —Ä—É–±.</p>
            {% if order.delivery_city != 'tula' %}
            <p><strong>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ:</strong> {{ order.delivery_distance }} –∫–º</p>
            {% endif %}
        </div>
        {% endif %}
        
        <div class="order-total">
            {% if order_items %}
            <strong>–¢–æ–≤–∞—Ä—ã: {{ total_price|floatformat:2 }} —Ä—É–±.</strong>
            {% endif %}
            {% if order.delivery_method == 'delivery' %}
            <br><strong>–î–æ—Å—Ç–∞–≤–∫–∞: {{ delivery_price|floatformat:2 }} —Ä—É–±.</strong>
            {% endif %}
            <br><strong>–ò—Ç–æ–≥–æ: {{ final_total|floatformat:2 }} —Ä—É–±.</strong>
        </div>
        
        <div class="order-info">
            <p><strong>–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è:</strong> 
                {% if order.delivery_method == 'delivery' %}–î–æ—Å—Ç–∞–≤–∫–∞{% else %}–°–∞–º–æ–≤—ã–≤–æ–∑{% endif %}
            </p>
            <p><strong>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</strong> 
                {% if order.payment_method == 'cash' %}–ù–∞–ª–∏—á–Ω—ã–º–∏
                {% elif order.payment_method == 'card' %}–ö–∞—Ä—Ç–æ–π
                {% else %}–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞{% endif %}
            </p>
            {% if order.customer_name %}
            <p><strong>–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞:</strong> {{ order.customer_name }}</p>
            {% endif %}
            {% if order.customer_phone %}
            <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ order.customer_phone }}</p>
            {% endif %}
        </div>
    </div>
    
    <div class="success-actions">
        <a href="{% url 'menu:menu_list' %}" class="success-btn btn-menu">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</a>
        <a href="{% url 'homepage:home' %}" class="success-btn btn-home">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        <a href="{% url 'homepage:profile' %}" class="success-btn btn-profile">–í –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
    </div>
</div>

<style>
.order-success-page {
    max-width: 800px;
    margin: 0 auto;
    padding: 30px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.success-icon {
    font-size: 80px;
    text-align: center;
    margin: 20px 0;
    animation: bounce 1s infinite alternate;
}

@keyframes bounce {
    from { transform: translateY(0); }
    to { transform: translateY(-10px); }
}

.order-details {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 10px;
    margin: 25px 0;
}

.order-items {
    margin: 20px 0;
    padding: 20px;
    background: white;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.order-item {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid rgba(0,0,0,0.05);
}

.order-item:last-child {
    border-bottom: none;
}

.order-total {
    background: #4ecdc4;
    color: white;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
    text-align: center;
    font-size: 1.2em;
}

.order-total strong {
    display: block;
    margin: 8px 0;
}

.order-info {
    background: white;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #ffd166;
}

.order-info p {
    margin: 10px 0;
    padding: 8px 0;
    border-bottom: 1px solid #f8f9fa;
}

.order-info p:last-child {
    border-bottom: none;
}

.no-items {
    text-align: center;
    color: #6c757d;
    font-style: italic;
    padding: 20px;
    background: white;
    border-radius: 8px;
    border: 2px dashed #dee2e6;
}

.success-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
    align-items: center;
    margin-top: 30px;
}

.success-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    padding: 15px 25px;
    border-radius: 25px;
    font-weight: bold;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    white-space: nowrap;
    box-sizing: border-box;
    min-width: 200px;
    height: 54px;
    font-size: 16px;
    text-align: center;
}

.btn-menu {
    background: #4ecdc4;
    color: white;
    border-color: #4ecdc4;
}

.btn-menu:hover {
    background: #3db8af;
    border-color: #3db8af;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
}

.btn-home {
    background: #ffd166;
    color: #333;
    border-color: #ffd166;
}

.btn-home:hover {
    background: #ffc745;
    border-color: #ffc745;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 209, 102, 0.4);
}

.btn-profile {
    background: #06d6a0;
    color: white;
    border-color: #06d6a0;
}

.btn-profile:hover {
    background: #04c290;
    border-color: #04c290;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(6, 214, 160, 0.4);
}

@media (max-width: 768px) {
    .order-success-page {
        padding: 15px;
    }
    
    .success-actions {
        flex-direction: column;
        width: 100%;
    }
    
    .success-btn {
        width: 100%;
        min-width: auto;
    }
}
.item-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.item-image {
    width: 60px;
    height: 60px;
    border-radius: 8px;
    object-fit: cover;
}

.item-title {
    font-weight: 600;
    color: #333;
}

.item-price {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 5px;
}

.item-total {
    font-weight: bold;
    color: #ef476f;
    font-size: 1.1em;
}
</style>
{% endblock %}